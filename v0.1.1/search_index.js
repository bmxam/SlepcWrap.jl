var documenterSearchIndex = {"docs":
[{"location":"api/eps/#Eigenvalue-Problem-solver-(EPS)","page":"Eigenvalue Problem solver (EPS)","title":"Eigenvalue Problem solver (EPS)","text":"","category":"section"},{"location":"api/eps/","page":"Eigenvalue Problem solver (EPS)","title":"Eigenvalue Problem solver (EPS)","text":"Modules = [SlepcWrap]\nPages   = [\"eps.jl\"]","category":"page"},{"location":"api/eps/#SlepcWrap.EPSCreate-Tuple{Any,SlepcEPS}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSCreate","text":"EPSCreate(comm, eps::SlepcEPS)\n\nWrapper for EPSCreate\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSDestroy-Tuple{SlepcEPS}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSDestroy","text":"EPSDestroy(eps::SlepcEPS)\n\nWrapper for EPSDestroy\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSGetConverged-Tuple{SlepcEPS}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSGetConverged","text":"EPSGetConverged(eps::SlepcEPS)\n\nWrapper for EPSGetConverged\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSGetEigenpair-Tuple{SlepcEPS,Any,PetscWrap.PetscVec,PetscWrap.PetscVec}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSGetEigenpair","text":"EPSGetEigenpair(eps::SlepcEPS, ieig, vecr::PetscVec, veci::PetscVec)\n\nWrapper for EPSGetEigenpair. ieig must be in [1, EPSGetConverged]; it does't start at 0 as in Slepc API.\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSGetEigenpair-Tuple{SlepcEPS,Any}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSGetEigenpair","text":"EPSGetEigenpair(eps::SlepcEPS, ieig)\n\nWrapper for EPSGetEigenpair without providing pre-allocated vec. nor one of the operator matrix\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSGetEigenpair-Tuple{SlepcEPS,PetscWrap.PetscMat,Any}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSGetEigenpair","text":"EPSGetEigenpair(eps::SlepcEPS, mat::PetscMat, ieig)\n\nWrapper for EPSGetEigenpair without providing pre-allocated vec. but providing one of the operator matrix\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSGetEigenvalue-Tuple{SlepcEPS,Any}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSGetEigenvalue","text":"EPSGetEigenvalue(eps::SlepcEPS, ieig)\n\nWrapper for EPSGetEigenvalue . ieig must be in [1, EPSGetConverged]; it does't start at 0 as in Slepc API.\n\nA tuple (real, imag) is returned.\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSGetOperators-Tuple{SlepcEPS}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSGetOperators","text":"EPSGetOperators(eps::SlepcEPS)\n\nWrapper for EPSGetOperators\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSGetTolerances-Tuple{SlepcEPS}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSGetTolerances","text":"EPSGetTolerances(eps::SlepcEPS)\n\nWrapper for EPSGetTolerances\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSSetFromOptions-Tuple{SlepcEPS}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSSetFromOptions","text":"EPSSetFromOptions(eps::SlepcEPS)\n\nWrapper for EPSSetFromOptions\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSSetOperators-Tuple{SlepcEPS,PetscWrap.PetscMat,PetscWrap.PetscMat}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSSetOperators","text":"EPSSetOperators(eps::SlepcEPS, A::PetscMat, B::PetscMat)\n\nWrapper for EPSSetOperators with two matrices\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSSetOperators-Tuple{SlepcEPS,PetscWrap.PetscMat}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSSetOperators","text":"EPSSetOperators(eps::SlepcEPS, A::PetscMat)\n\nWrapper for EPSSetOperators with only one matrix\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSSetUp-Tuple{SlepcEPS}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSSetUp","text":"EPSSetUp(eps::SlepcEPS)\n\nWrapper for EPSSetup\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSSolve-Tuple{SlepcEPS}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSSolve","text":"EPSSolve(eps::SlepcEPS)\n\nWrapper for EPSSolve\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.EPSView","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.EPSView","text":"EPSView(eps::SlepcEPS, view::PetscViewer = C_NULL)\n\nWrapper for EPSView\n\n\n\n\n\n","category":"function"},{"location":"api/eps/#SlepcWrap.create_eps-Tuple{PetscWrap.PetscMat,PetscWrap.PetscMat}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.create_eps","text":"create_eps(A::PetscMat, B::PetscMat)\n\nFor a generalized eigenvalue problem\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.create_eps-Tuple{PetscWrap.PetscMat}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.create_eps","text":"create_eps(A::PetscMat)\n\nFor a standard eigenvalue prolem.\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.get_eig-Tuple{SlepcEPS,Any}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.get_eig","text":"get_eig(eps::SlepcEPS, ieigs)\n\nGet the ieig-th eigenvalues as a complex array.\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.get_eig-Tuple{SlepcEPS,Integer}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.get_eig","text":"get_eig(eps::SlepcEPS, ieig::Integer)\n\nGet the ieig-th eigenvalue as a complex number.\n\n\n\n\n\n","category":"method"},{"location":"api/eps/#SlepcWrap.get_eigs-Tuple{SlepcEPS}","page":"Eigenvalue Problem solver (EPS)","title":"SlepcWrap.get_eigs","text":"get_eigs(eps::SlepcEPS)\n\nReturns all the converged eigenvalues as one complex array\n\n\n\n\n\n","category":"method"},{"location":"example/helmholtz2/#Helmholtz-equation","page":"Helmholtz equation","title":"Helmholtz equation","text":"","category":"section"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"In this example, we use the SLEPc to find the eigenvalues of the following Helmholtz equation: u + omega^2 u = 0 associated to Dirichlet boundary conditions on the domain 01. Hence the theoritical eigenvalues are omega = k pi with k in mathbbZ^*; and the associated eigenvectors are u(x) = sin(kpix). A centered finite difference scheme is used for the spatial discretization.","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"The equation is written in matrix form Au = alpha Bu where alpha = omega^2.","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"To run this example, simplfy excute mpirun -n your_favourite_integer julia helmholtz_FD.jl","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"In this example, \"fancy\" names are use to interface with PETSc/SLEPc. For legacy method names check the previous example.","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Note that the way we achieve things in the document can be highly improved and the purpose of this example is only demonstrate some method calls to give an overview.","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Start by importing both PetscWrap, for the distributed matrices, and SlepcWrap for the eigenvalues.","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"using PetscWrap\nusing SlepcWrap","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Number of mesh points and mesh step","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"n = 21\nΔx = 1. / (n - 1)","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Initialize SLEPc. Either without arguments, calling SlepcInitialize() or using \"command-line\" arguments. To do so, either provide the arguments as one string, for instance SlepcInitialize(\"-eps_max_it 100 -eps_tol 1e-5\") or provide each argument in separate strings : PetscInitialize([\"-eps_max_it\", \"100\", \"-eps_tol\", \"1e-5\"). Here we ask for the five closest eigenvalues to 0, using a non-zero pivot for the LU factorization and a \"shift-inverse\" process.","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"SlepcInitialize(\"-eps_target 0 -eps_nev 5 -st_pc_factor_shift_type NONZERO -st_type sinvert\")","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Create the problem matrices, set sizes and apply \"command-line\" options. Note that we should set the number of preallocated non-zeros to increase performance.","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"A = create_matrix(n, n)\nB = create_matrix(n, n)\nset_from_options!(A)\nset_from_options!(B)\nset_up!(A)\nset_up!(B)","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Get rows handled by the local processor","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"A_rstart, A_rend = get_range(A)\nB_rstart, B_rend = get_range(B)","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Fill matrix A  with second order derivative central scheme","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"for i in A_rstart:A_rend\n    if(i == 1)\n        A[1, 1:2] = [-2., 1] / Δx^2\n    elseif (i == n)\n        A[n, n-1:n] = [1., -2.] / Δx^2\n    else\n        A[i, i-1:i+1] = [1., -2., 1.] / Δx^2\n    end\nend","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Fill matrix B with identity matrix","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"for i in B_rstart:B_rend\n    B[i,i] = -1.\nend","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Set boundary conditions : u(0) = 0 and u(1) = 0. Only the processor handling the corresponding rows are playing a role here.","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"(A_rstart == 1) && (A[1, 1:2] = [1. 0.] )\n(B_rstart == 1) && (B[1,   1] = 0.      )\n\n(A_rend == n) && (A[n, n-1:n] = [0. 1.] )\n(B_rend == n) && (B[n,     n] = 0.      )","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Assemble the matrices","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"assemble!(A)\nassemble!(B)","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Now we set up the eigenvalue solver","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"eps = create_eps(A, B)\nset_from_options!(eps)\nset_up!(eps)","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Then we solve","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"solve!(eps)","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"And finally we can inspect the solution. Let's first get the number of converged eigenvalues:","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"nconv = neigs(eps)","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Then we can get/display these eigenvalues (more precisely their square root, i.e simeq omega)","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"for ieig in 1:nconv\n    eig = get_eig(eps, ieig)\n    @show √(real(eig))\nend","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"You can also get all the converged eigenvalues in one call","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"eigs = get_eigenvalues(eps)","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"We can also play with eigen vectors.","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"for ieig in 1:nconv\n    vpr, vpi, vecpr, vecpi = get_eigenpair(eps, ieig)\n\n    # At this point, you can call VecGetArray to obtain a Julia array (see PetscWrap examples).\n    # If you are on one processor, you can even plot the solution to check that you have a sinus\n    # solution. On multiple processors, this would require to \"gather\" the solution on one processor only.\nend","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Finally, let's free the memory","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"destroy!(A)\ndestroy!(B)\ndestroy!(eps)","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"And call finalize when you're done","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"SlepcFinalize()\n","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"","category":"page"},{"location":"example/helmholtz2/","page":"Helmholtz equation","title":"Helmholtz equation","text":"This page was generated using Literate.jl.","category":"page"},{"location":"api/init/#Initialization","page":"Initialization","title":"Initialization","text":"","category":"section"},{"location":"api/init/","page":"Initialization","title":"Initialization","text":"Modules = [SlepcWrap]\nPages   = [\"init.jl\"]","category":"page"},{"location":"api/init/#SlepcWrap.SlepcFinalize-Tuple{}","page":"Initialization","title":"SlepcWrap.SlepcFinalize","text":"Wrapper to SlepcFinalize\n\n\n\n\n\n","category":"method"},{"location":"api/init/#SlepcWrap.SlepcInitialize-Tuple{Array{String,1},String,String}","page":"Initialization","title":"SlepcWrap.SlepcInitialize","text":"Wrapper to SlepcInitializeNoPointers\n\nImplementation\n\nI don't know if I am supposed to use PetscInt or not...\n\n\n\n\n\n","category":"method"},{"location":"api/init/#SlepcWrap.SlepcInitialize-Tuple{}","page":"Initialization","title":"SlepcWrap.SlepcInitialize","text":"Wrapper to SlepcInitializeNoArguments\n\n\n\n\n\n","category":"method"},{"location":"example/helmholtz1/#Helmholtz-equation","page":"Helmholtz equation","title":"Helmholtz equation","text":"","category":"section"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"In this example, we use the SLEPc to find the eigenvalues of the following Helmholtz equation: u + omega^2 u = 0 associated to Dirichlet boundary conditions on the domain 01. Hence the theoritical eigenvalues are omega = k pi with k in mathbbZ^*; and the associated eigenvectors are u(x) = sin(kpix). A centered finite difference scheme is used for the spatial discretization.","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"The equation is written in matrix form Au = alpha Bu where alpha = omega^2.","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"To run this example, simplfy excute mpirun -n your_favourite_integer julia helmholtz_FD.jl","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"In this example, PETSc/SLEPc legacy method names are used. For more fancy names, check the next example.","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Note that the way we achieve things in the document can be highly improved and the purpose of this example is only demonstrate some method calls to give an overview.","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Start by importing both PetscWrap, for the distributed matrices, and SlepcWrap for the eigenvalues.","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"using PetscWrap\nusing SlepcWrap","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Number of mesh points and mesh step","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"n = 21\nΔx = 1. / (n - 1)","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Initialize SLEPc. Either without arguments, calling SlepcInitialize() or using \"command-line\" arguments. To do so, either provide the arguments as one string, for instance SlepcInitialize(\"-eps_max_it 100 -eps_tol 1e-5\") or provide each argument in separate strings : PetscInitialize([\"-eps_max_it\", \"100\", \"-eps_tol\", \"1e-5\"). Here we ask for the five closest eigenvalues to 0, using a non-zero pivot for the LU factorization and a \"shift-inverse\" process.","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"SlepcInitialize(\"-eps_target 0 -eps_nev 5 -st_pc_factor_shift_type NONZERO -st_type sinvert\")","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Create the problem matrices, set sizes and apply \"command-line\" options. Note that we should set the number of preallocated non-zeros to increase performance.","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"A = MatCreate()\nB = MatCreate()\nMatSetSizes(A, PETSC_DECIDE, PETSC_DECIDE, n, n)\nMatSetSizes(B, PETSC_DECIDE, PETSC_DECIDE, n, n)\nMatSetFromOptions(A)\nMatSetFromOptions(B)\nMatSetUp(A)\nMatSetUp(B)","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Get rows handled by the local processor","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"A_rstart, A_rend = MatGetOwnershipRange(A)\nB_rstart, B_rend = MatGetOwnershipRange(B)","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Fill matrix A  with second order derivative central scheme","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"for i in A_rstart:A_rend\n    if(i == 1)\n        A[1, 1:2] = [-2., 1] / Δx^2\n    elseif (i == n)\n        A[n, n-1:n] = [1., -2.] / Δx^2\n    else\n        A[i, i-1:i+1] = [1., -2., 1.] / Δx^2\n    end\nend","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Fill matrix B with identity matrix","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"for i in B_rstart:B_rend\n    B[i,i] = -1.\nend","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Set boundary conditions : u(0) = 0 and u(1) = 0. Only the processor handling the corresponding rows are playing a role here.","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"(A_rstart == 1) && (A[1, 1:2] = [1. 0.] )\n(B_rstart == 1) && (B[1,   1] = 0.      )\n\n(A_rend == n) && (A[n, n-1:n] = [0. 1.] )\n(B_rend == n) && (B[n,     n] = 0.      )","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Assemble the matrices","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"MatAssemblyBegin(A, MAT_FINAL_ASSEMBLY)\nMatAssemblyBegin(B, MAT_FINAL_ASSEMBLY)\nMatAssemblyEnd(A, MAT_FINAL_ASSEMBLY)\nMatAssemblyEnd(B, MAT_FINAL_ASSEMBLY)","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Now we set up the eigenvalue solver","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"eps = EPSCreate()\nEPSSetOperators(eps, A, B)\nEPSSetFromOptions(eps)\nEPSSetUp(eps)","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Then we solve","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"EPSSolve(eps)","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"And finally we can inspect the solution. Let's first get the number of converged eigenvalues:","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"nconv = EPSGetConverged(eps)","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Then we can get/display these eigenvalues (more precisely their square root, i.e simeq omega)","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"for ieig in 1:nconv\n    vpr, vpi = EPSGetEigenvalue(eps, ieig)\n    @show √(vpr), √(vpi)\nend","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"We can also play with eigen vectors. First, create two Petsc vectors to allocate memory","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"vecr, veci = MatCreateVecs(A)","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Then loop over the eigen pairs and retrieve eigenvectors","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"for ieig in 1:nconv\n    vpr, vpi, vecpr, vecpi = EPSGetEigenpair(eps, ieig, vecr, veci)\n\n    # At this point, you can call VecGetArray to obtain a Julia array (see PetscWrap examples).\n    # If you are on one processor, you can even plot the solution to check that you have a sinus\n    # solution. On multiple processors, this would require to \"gather\" the solution on one processor only.\nend","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"Finally, let's free the memory","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"MatDestroy(A)\nMatDestroy(B)\nEPSDestroy(eps)","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"And call finalize when you're done","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"SlepcFinalize()\n","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"","category":"page"},{"location":"example/helmholtz1/","page":"Helmholtz equation","title":"Helmholtz equation","text":"This page was generated using Literate.jl.","category":"page"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = SlepcWrap","category":"page"},{"location":"#SlepcWrap.jl","page":"Home","title":"SlepcWrap.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Check out the examples or the API.","category":"page"}]
}
